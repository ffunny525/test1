<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>理解姚式百萬富翁問題</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1 id="toc_0">理解姚氏百萬富翁問題</h1>

<h2 id="toc_1">目標</h2>

<blockquote>
<p>兩個百萬富翁Alice＆Bob  </p>

<blockquote>
<p>如何在<strong>「不向對方透露任何身家訊息」&amp; 「第三方也不知道」</strong>的前提下<strong>「比較各自的財富」</strong>？ </p>
</blockquote>
</blockquote>

<p>乍看感覺不是什麼特別複雜的問題，比如你可能會回答：</p>

<blockquote>
<p>用天平，每個富商領到一個質量固定的黑箱，讓富商在其中放入質量與財富相對應的籌碼（例如除以1000000）。放在天平兩邊看哪邊重一點，應該這樣就解決了。</p>
</blockquote>

<h2 id="toc_2">問題描述</h2>

<p>假設富翁Alice和Bob分別有 <a href="http://www.codecogs.com/eqnedit.php?latex=i\,&space;,&space;\,&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?i\,&space;,&space;\,&space;j" title="i\, , \, j" /></a> 億資產，其中 <a href="http://www.codecogs.com/eqnedit.php?latex=0<&space;i,j\leqslant&space;10" target="_blank"><img src="http://latex.codecogs.com/gif.latex?0<&space;i,j\leqslant&space;10" title="0< i,j\leqslant 10" /></a></p>

<p>（為了方便解說，假設兩人財富都在1~10之間，但其實上限可擴展到任意正整數）</p>

<p>（假設Alice和Bob都是君子，都是誠實可信的，會嚴格遵守協議，不會撒謊，會嚴格執行下面的算法）</p>

<p>（最終，這個協議可以讓雙方比較出 <a href="http://www.codecogs.com/eqnedit.php?latex=i\,&space;,&space;\,&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?i\,&space;,&space;\,&space;j" title="i\, , \, j" /></a> 的大小，而不透露<a href="http://www.codecogs.com/eqnedit.php?latex=i\,&space;,&space;\,&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?i\,&space;,&space;\,&space;j" title="i\, , \, j" /></a> 實際值。這個協議整個過程也不需要第三方的參與。）</p>

<h2 id="toc_3">以例子看思路</h2>

<p>設富翁Alice有4百萬，富翁Bob有2百萬，  也就是 <a href="http://www.codecogs.com/eqnedit.php?latex=i=4,\,&space;j=2" target="_blank"><img src="http://latex.codecogs.com/gif.latex?i=4,\,&space;j=2" title="i=4,\, j=2" /></a></p>

<p>（雙方互不知道對方的資產。算法過程如下）</p>

<ol>
<li><p><font color=gray size=3>生成 <a href="http://www.codecogs.com/eqnedit.php?latex=N-bit" target="_blank"><img src="http://latex.codecogs.com/gif.latex?N-bit" title="N-bit" /></a>  正整數集 <em>M</em>，bit是二進制位</font>，設N=5（實際操作中N應該根據 <em>i，j</em> 的上限取值，而且越大越好。但為了方便解釋這裡的取值較小），生成正整數集 <em>M</em> 如下，共計16個數： // <font color=red size=4>不懂？？為什麼是16個？為什麼是16開始？? 誰生成？是系統嗎？</font></p>

<div><pre><code class="language-none">正整數集 M ：

16，17，18，19，20，...，29，30，31</code></pre></div></li>
<li><p><font color=gray size=3>生成<a href="http://www.codecogs.com/eqnedit.php?latex=M-M" target="_blank"><img src="http://latex.codecogs.com/gif.latex?M-M" title="M-M" /></a>的所有一對一映射集合<a href="http://www.codecogs.com/eqnedit.php?latex=Q_{N}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?Q_{N}" title="Q_{N}" /></a>。</font></p>

<p>則步驟1的例子中，得到的<a href="http://www.codecogs.com/eqnedit.php?latex=Q_{N}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?Q_{N}" title="Q_{N}" /></a>集合 有  <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;16!" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;16!" title="\large 16!" /></a> 個元素。</p></li>
<li><p>協議開始之前，Alice先產生一對RSA金鑰。</p>

<p>Alice隨機選了<a href="http://www.codecogs.com/eqnedit.php?latex=Q_{N}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?Q_{N}" title="Q_{N}" /></a> 中的一個元素當作公鑰 e（使得Bob可用於傳遞經過加密的訊息），並告知Bob（注意：這個<em>映射關係的反向就是『私鑰』</em>，<em>Alice不能將私鑰告訴Bob</em>），設Alice選擇的公鑰為：// <font color=red size=4>不懂？？不是說選擇『一個』元素嗎？ 怎麼又有這麼多數字跑出來？而且好像沒有說公鑰e是什麼，但我看到後面好像也沒特別要用到這個公鑰，而且好像也沒看到兩個質數相乘的n</font></p>

<div><pre><code class="language-none">所有16!個元素，映射

16-24，17-16，18-29，19-31，20-17，21-22，22-27，23-28，24-18，25-30，26-25，27-19，28-23，29-26，30-21，31-30

//不懂這規則在哪？
</code></pre></div></li>
<li><p>Bob也隨機選擇一個 <a href="http://www.codecogs.com/eqnedit.php?latex=N-bit" target="_blank"><img src="http://latex.codecogs.com/gif.latex?N-bit" title="N-bit" /></a> 的正整數 <a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a>，因為 <a href="http://www.codecogs.com/eqnedit.php?latex=x\in&space;M" target="_blank"><img src="http://latex.codecogs.com/gif.latex?x\in&space;M" title="x\in M" /></a>  <font color=red size=4>（不懂？？為何x 屬於M）</font>
，所以Bob可以用Alice給的公鑰，給自己選擇的隨機數<a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a>加密，找到對應 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;x" title="\large x" /></a> 的對應元素  密文 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k" title="\large k" /></a> ，假設 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;x=20" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;x=20" title="\large x=20" /></a> ，則對應的  密文 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k=17" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k=17" title="\large k=17" /></a></p>

<p>//<font color=red size=4>不知道Alice給的公開金鑰e &amp; n是什麼，要不然公式應該長這樣...</font></p>

<p><a href="http://www.codecogs.com/eqnedit.php?latex=k=E(x)=x^{e}\,&space;\,&space;mod\,&space;\,&space;n" target="_blank"><img src="http://latex.codecogs.com/gif.latex?k=E(x)=x^{e}\,&space;\,&space;mod\,&space;\,&space;n" title="k=E(x)=x^{e}\, \, mod\, \, n" /></a></p>

<p>Bob 將 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k-j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k-j" title="\large k-j" /></a> 的結果傳送給Alice， 也就是Bob將 <a href="http://www.codecogs.com/eqnedit.php?latex=17-2=15" target="_blank"><img src="http://latex.codecogs.com/gif.latex?17-2=15" title="17-2=15" /></a> 傳過去給Alice（告訴Alice說：我Bob，手上的密文k扣掉我的財富i後，結果是15） 。</p></li>
<li><p><em>Alice 只知道15，但不知道Bob手上的密文 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k=17" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k=17" title="\large k=17" /></a>和Bob的真實財富 <a href="http://www.codecogs.com/eqnedit.php?latex=j=2" target="_blank"><img src="http://latex.codecogs.com/gif.latex?j=2" title="j=2" /></a></em>。  </p>

<p><a href="http://www.codecogs.com/eqnedit.php?latex=k-j=15\,&space;\,&space;\Rightarrow&space;k=15&plus;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?k-j=15\,&space;\,&space;\Rightarrow&space;k=15&plus;j" title="k-j=15\, \, \Rightarrow k=15+j" /></a></p>

<p>如果Alice想解出Bob將隨機數 <a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a>再加密後的密文<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k" title="\large k" /></a> 到底是什麼的話，Alice就必須一個一個將Bob傳過來的15加上所有可能的 Bob財富數字 <em>j</em>  才會回到他想知道的密文<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k" title="\large k" /></a> ，所有密文<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k" title="\large k" /></a> 可能的組合</p>

<div><pre><code class="language-none"> 15+1
 15+『2』
 ...
 15+ 10

 所有密文k有可能的組合= [16,『17』,18,19,20,21,22,23,24,25]</code></pre></div>

<p>Alice再將自己的私鑰 <font color=red size=4>（n, d但本例子似乎沒出現）</font>對上面十個可能的密文<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;k" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;k" title="\large k" /></a> 解密，想解密回Bob之前隨機選的數字（明文）<a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a></p>

<p><a href="http://www.codecogs.com/eqnedit.php?latex=x=D(k)=k^{d}\,&space;mod\,&space;n" target="_blank"><img src="http://latex.codecogs.com/gif.latex?x=D(k)=k^{d}\,&space;mod\,&space;n" title="x=D(k)=k^{d}\, mod\, n" /></a></p>

<p>故，產生了以下序列  <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;y{_{u}}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;y{_{u}}" title="\large y{_{u}}" /></a> ，裡面都是Bob之前隨機選的數字<a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a>「有可能」的數字</p>

<div><pre><code class="language-none">解出來的可能的x有以下十種結果（只有一個恰好等於x，其餘的數其實都沒啥意義。）

但這題似乎沒給d 和 n 所以...我暫且直接將yu給亂亂寫...
yu = [17,『20』,24,27,31,30,21,28,16,26]</code></pre></div>

<p>接下來，Alice再選取 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;N/2&space;-bit" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;N/2&space;-bit" title="\large N/2 -bit" /></a> 的質數 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> （會比x小），再將 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;y{_{u}}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;y{_{u}}" title="\large y{_{u}}" /></a> 中每個元素除以<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> 得到的餘數（也就是<a href="http://www.codecogs.com/eqnedit.php?latex=y_{u}\,&space;\,&space;mod\,&space;\,&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?y_{u}\,&space;\,&space;mod\,&space;\,&space;p" title="y_{u}\, \, mod\, \, p" /></a> ）計作序列 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}" title="\large Z_{u}" /></a> ，而且<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}" title="\large Z_{u}" /></a> 至少有兩個元素『不相同』，這樣的質數<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> 才滿足條件，否則這個<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> 就要被換掉。這邊選擇 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p=3" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p=3" title="\large p=3" /></a> ，則 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}" title="\large Z_{u}" /></a> 如下： // <font color=red size=4>不懂？？為什麼至少有兩個元素『不相同』而且這一步驟的目的是什麼？為麼要mod p？而且p比x小的目的為何？</font></p>

<div><pre><code class="language-none">zu = [2,『2』,0,0,1,0,0,1,1,2]</code></pre></div>

<blockquote>
<p>注意『取出』十個明文除以質數p的餘數。這一步不能省略！（後面說明為什麼）</p>
</blockquote></li>
<li><p>Alice將這個   <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}" title="\large Z_{u}" /></a> 進行處理，保持前面 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;i" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;i" title="\large i" /></a> 個數字不變（自己的財富數字i個數不動），從第 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;i&plus;1" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;i&plus;1" title="\large i+1" /></a>     個數到最後一個數全部增加1，變成新的序列 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'" title="\large Z_{u}{}'" /></a> ，再把 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'" title="\large Z_{u}{}'" /></a> 和質數 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> 一起傳給Bob，如下： // <font color=red size=4>不懂？？為什麼Alice要自己的(財富+1)
項開始，每個數字都加一？</font></p>

<div><pre><code class="language-none">zu&#39; = [2,『2』,0,0,{2},{1},{1},{2},{2},{3}],  
p = 3
</code></pre></div></li>
<li><p>Bob 拿到 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'" title="\large Z_{u}{}'" /></a> 和質數 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;p" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;p" title="\large p" /></a> 後，會去查看 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'" title="\large Z_{u}{}'" /></a>  中的第 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;j" title="\large j" /></a> 個元素 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'&space;\left&space;\{&space;j&space;\right&space;\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'&space;\left&space;\{&space;j&space;\right&space;\}" title="\large Z_{u}{}' \left \{ j \right \}" /></a> ，如果 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;x&space;\,&space;\,&space;mod\,&space;\,&space;p&space;\,&space;=Z_{u}{}'&space;\left&space;\{&space;j&space;\right&space;\}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;x&space;\,&space;\,&space;mod\,&space;\,&space;p&space;\,&space;=Z_{u}{}'&space;\left&space;\{&space;j&space;\right&space;\}" title="\large x \, \, mod\, \, p \, =Z_{u}{}' \left \{ j \right \}" /></a> ，那麼 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;i\geqslant&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;i\geqslant&space;j" title="\large i\geqslant j" /></a>  （Bob財富少於Alice ），反之 ，若兩者不相同，代表第 <em>j</em> 個數字已經被Alice處理過了， <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;i<&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;i<&space;j" title="\large i< j" /></a> （Bob錢比Alice多）。</p>

<p>因為本例中<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;j=2" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;j=2" title="\large j=2" /></a> ，再檢查 <a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;Z_{u}{}'\left&space;\{&space;2&space;\right&space;\}&space;=2=20\,&space;\,&space;mod&space;\,&space;3" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;Z_{u}{}'\left&space;\{&space;2&space;\right&space;\}&space;=2=20\,&space;\,&space;mod&space;\,&space;3" title="\large Z_{u}{}'\left \{ 2 \right \} =2=20\, \, mod \, 3" /></a>， 所以Bob 得到結論了:
<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;i\geq&space;j" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;i\geq&space;j" title="\large i\geq j" /></a></p>

<blockquote>
<p>白話自己看：
Bob只需要去算自己選的隨機數x（此題給20）去mod p 的結果，
看是否等於Alice傳來的Zu&#39;序列中第2個數字（代表Bob財富的數字『2』）</p>

<p>Bob計算出 <a href="http://www.codecogs.com/eqnedit.php?latex=20\equiv&space;2&space;\,&space;\,&space;mod\,&space;\,&space;3" target="_blank"><img src="http://latex.codecogs.com/gif.latex?20\equiv&space;2&space;\,&space;\,&space;mod\,&space;\,&space;3" title="20\equiv 2 \, \, mod\, \, 3" /></a></p>

<p>代表這個Zu&#39;序列中第2個數（代表我Bob的財富）還沒<code>被+1</code>，
<code>被+1</code>的項還放在我的後面，也就是說，我Bob的錢其實是少於對方Alice的！</p>
</blockquote></li>
<li><p>Bob 最後將結果告訴Alice，算法結束。 </p></li>
</ol>

<hr>

<h3 id="toc_4">解釋</h3>

<blockquote>
<p>第6步驟中，『取出』十個明文除以質數p的餘數。這一步不能省略！</p>
</blockquote>

<p>因為如果省略了質數p的參與，直接進入第6步驟，Alice會得到<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;y_{u}^{wrong}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;y_{u}^{wrong}" title="\large y_{u}^{wrong}" /></a> 然後再傳給Bob。</p>

<div><pre><code class="language-none">yu wrong = [17,20,24,27,32,31,22,29,17,27]

然後再傳給Bob。
</code></pre></div>

<p>Bob在查看了第2個元素後，發現這個元素與  <a href="http://www.codecogs.com/eqnedit.php?latex=\dpi{120}&space;\large&space;x" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\dpi{120}&space;\large&space;x" title="\large x" /></a>一樣，Bob就知道Alice比自己有錢了。</p>

<blockquote>
<p>Bob 如果更不服輸的話，為了知道自己到底輸了多少，所以去看看Alice到底有多少錢。</p>

<blockquote>
<p>Bob 將Alice給的公鑰<a href="http://www.codecogs.com/eqnedit.php?latex=\large&space;y_{u}^{wrong}" target="_blank"><img src="http://latex.codecogs.com/gif.latex?\large&space;y_{u}^{wrong}" title="\large y_{u}^{wrong}" /></a>  中的數字全部編碼，就得到
<code>16，17，18，19</code>這樣的自然序列，在第5個元素的時候，發現找不到對應的加密方式了（數字32在本例中產生了溢出，如果序列範圍更大理論上可以避免），第6個元素對應的密文為20，第7個元素對應密文為27…從第5個元素開始就已經被Alice處理過了，於是Bob知道了，Alice的資產是4百萬。</p>
</blockquote>
</blockquote>

<p>// 從這個過程我們看出，一定需要<font color=red size=4>合適的質數p
來對Alice的信息加密。</font></p>

<h2 id="toc_5">小結</h2>

<p>引用Vichare Wang的一段回答：</p>

<blockquote>
<p>第一步，經過特定的操作，讓Alice構造出 n 把鎖，Bob只有第 j 把鎖的鑰匙，但是Alice不知道 j 是多少；</p>

<p>第二步，Alice給Bob n 把鎖其鎖著的標誌位置，其中前 i 個標誌位置0，後 n-i 個置1；</p>

<p>第三步，B檢查第 j 把鎖鎖著的標誌位是否為0。如果為0則 i &gt;= j，否則 i &lt; j。</p>
</blockquote>

<p>這差不多就是這個算法的精髓所在。</p>

<p>參考文章：<a href="http://leohope.com/%E8%A7%A3%E9%97%AE%E9%A2%98/2017/10/13/millionare/">http://leohope.com/%E8%A7%A3%E9%97%AE%E9%A2%98/2017/10/13/millionare/</a></p>

<h2 id="toc_6">引入安全多方運算(Secure Multiparty Computation)</h2>

<p>這個過程的絕妙之處在於：在協議完成之後，Alice不知道Bob的財富 j 的到底是多少？Bob也不知道 Alice財富i 的值， 但是雙方卻可以知道誰的財富比較多，這就是安全多方計算。</p>

<blockquote>
<p>一般來說，在甲只知道 x，乙只知道 y 的情況下，雙方可以合作計算一個函數 f(x,y)。協議完成時，只有函數值是公開的，而彼此都不知道對方的輸入值。</p>
</blockquote>




</body>

</html>
